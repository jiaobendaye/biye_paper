% !Mode:: "TeX:UTF-8"
\chapter{基于多目标BFO优化的双聚类算法}
多目标优化问题在工业界和生活中广泛存在，如著名背包问题。前面提到，双聚类有多个质量评价指标，其中一些是存在竞争的关系。基因表达数据的双聚类分析本质上就是一个多目标优化问题,而且已经有研究将多目标优化算法引入到基基因表达数据的双聚类分析中。本章先简要介绍多目标优化的基本知识，然后在根据细菌觅食算法的特点进行多目标的改进，最后通过实验进行算法的分析。

\section{多目标优化问题的基本概念}
假设$S\subset \mathbb{R}^n$为一个n维的搜索空间，$f_i(x),i=1,...,k$为定义在$S$上的k个目标函数，并且定义向量函数$f(x)$和m个不同的限制函数如下。
\begin{align}
   f(x) &= [f_1(x),f_2(x),...,f_k(x)] \\
    g(x) &\leq 0, i= 1,...,m
\end{align}
然后，我们想要找到一个解$x^{\ast} =(x_1^{\ast},x_2^{\ast},...,x_n^{\ast})$使得$f(x)$最小。但是，目标函数$f_i(x)$之间可能是互相冲突的，这使得不可能在$S$上找到一个全局的最优解。由于这个缘故，我们需要恰当地定义在多目标问题上的优化问题。

给定$u=(u_1,...,u_n)$和$v=(v_1,...,v_n)$为搜索空间$S$上的两个向量，当且仅当对于所有的$i=1,2,...,n$，$u_i \le v_i$都成立且至少有一维$u_i<v_i$成立，我们称$u$支配$v$。这一性质也称为帕雷托支配（Pareto Dominance）。当且仅当$S$中没有任何一个解$y$支配$x$，那么解$x$是该多目标问题的帕雷托最优解。也就是说$x$在$S$中是非支配的。$S$中也许会存在多个非支配解，它们的集合被称为帕雷托最优解集，并用$P^*$表示。集合
\begin{equation}
   PF^* = \{f(x): x\in P^*\} 
\end{equation}
被称为帕雷托前沿。帕雷托前沿可以是不连续的，并且部分是凸而部分是非凸的。这种性质可以视为多目标优化问题的难点所在。

基于帕雷托最优解的定义，多目标优化问题的主要目标可以看作对帕雷托最优解的寻找。然而，帕雷托最优解可能是无穷的，受限于计算时间和空间，我们只能追求一个更加实际的目标。因此，我们只能尽可能地寻找帕雷托最优解，使其帕雷托前沿经可能的扩张，与真实的帕雷托前沿的误差尽量小。

\section{基于多目标BFO搜索双聚类算法}
将单目标的BFO优化算法改进成多目标，需要对其趋向性操作和复制操作作出相应修改。本节结合Lavy飞行和多目标优化问题，提出基于多目标BFO搜索双聚类算法。

    \subsection{支配判断}
    不同于上一章将MSR．GV和CV通过权重系数直接相加的做法，结合多目标的情况，设计适应值函数如下。
    \begin{equation}
      f(x) = [MSR(x), -GV(x), -CV(x)]  
    \end{equation}
    这里一共有三个目标函数，根据帕雷托支配的定义，如果$f(x_a)\le f(x_b)$严格成立且至少存在某个目标函数$f_i(x)$，使得$f_i(x_a)<f_i(x_b)$,那么$x_a$支配$x_b$。
    
    \subsection{多目标趋向性操作}
    趋向性操作是指细菌在搜索区间中的随机搜索，每走一步都要和之前的解进行比较，如果新位置优于旧位置，则进行跟新，这是算法收敛的保证。同时，为了增加种群的多样性，本文为BFO增加了Levy飞行。而在多目标问题中，需要基于Pareto支配关系来决定是否更新位置。对于旧位置$x_{old}$和新位置$x_{new}$，如果之间相互支配，则选择支配位置而淘汰被支配位置，否则，进行归一化之后依据权重系数进行比较，如算法\ref{alg:norm}所示。

    \begin{algorithm}[htbp]
    \caption{归一化比较} \label{alg:norm}
    \KwIn{新旧位置$x_{new}$，$x_{old}$，目标函数的权重$weight$}
    \KwOut{较优的位置}%
    $f_{new} = f(x_{new})$　   //计算新位置的适应值\\
    $f_{old} = f(x_{old})$　 //计算旧位置的适应值\\
    $f_{total} = f_{new} + f_{old}$　   \\
    $percent_{new} = f_{new} \div f_{total}$　 //分别计算新旧个体中相同\\
    $percent_{new} = f_{new} \div f_{total}$　 //目标的函数值所占的比例\\
    $sub = percent_{new} - percent_{old}$ 　 //计算比例的差值\\
    $rate = sub \ast weight$　 //矩阵相乘各目标函数的权重\\
    \uIf{rate >0}{
       return $x_{new}$　 //若rate大于0，则新位置更优
    }
    \Else{
        return $x_{old}$
    }
    % \For{$i = 0;\ i < M;\ i = i + 2$}{
    %     Do something
    %     }
    \end{algorithm}

    \subsection{多目标复制操作}
    在标准的单目标的细菌觅食算法中，根据种群的适应值进行排序，并淘汰排在后面的细菌，同时将排在前面的细菌复制，保持种群的大小不变。但对于多个目标函数，需要自己定义一个排序规则。本文采取的是根据被被支配的次数来排序，被支配的次数越少则该个体越优。首先进行两两支配判断，然后统计出每个个体被支配的次数，最后根据次数排序。

    \subsection{外部集存放策略}
    为了维护种群的多样性，保存搜索过程中的非支配解，我们引入了外部集。每经过一次复制操作后，对于新产生的非支配解集，按照下面三个步骤加入到外部集中。
    \begin{enumerate}
       \item[(1)] 将新产生的非支配解集加入到外部集中并去重，如果外部集的大小没有变化，则说明都是重复的，直接返回，否则执行第（2）步
       \item[(2)] 计算外部集每个个体的被支配次数，然后淘汰支配次数非零的被支配解，如果剩余个数小于事先给定的阈值，则直接返回，否则执行（３）步
       \item[(3)] 剩余的都是非支配解，为了维持外部集的大小需要进行择优，具体过程如下所示。
    \end{enumerate} 
    \begin{algorithm}[htbp]
        \caption{更新外部集} \label{alg:updatePareto}
        \KwIn{帕雷托最优解集$P^*$，外部集最大个数OPSize, 目标函数权重weight}
        \KwOut{更新后的外部集}%
        $PF^*= \{f(x):x\in P^*\}$ 　 //计算帕雷托前沿 \\
        $f_{total} = sum(PF^*)$  　 //按目标函数相加\\
        $percent = PF^* \div　f_{total} $　 //计算个体在各目标函数所占的比例\\
        $ave = 1 \div |P^*|$　 //计算平均的比例\\
        $sub = percent - ave$　 //个体比例减去平均比例 \\
        $rate = sub \ast weight$　 //矩阵相乘各目标函数的权重\\
        $sort(P^*, rate)$　 //排序\\
        $outPareto = P^*[1:OPSize,:]$ 　 //淘汰排在PSize之后的解\\
        return outPareto
    \end{algorithm}
\section{实验结果及分析}
    \subsection{质量验证指标}

    \subsection{生物验证指标}

\section{本章小结}